@page "/authentication/{action}"
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication

<PageTitle>Authentication</PageTitle>

<RemoteAuthenticatorView Action="@Action">
    <LoggingIn>
        <MudContainer MaxWidth="MaxWidth.Small" Class="d-flex align-center justify-center" Style="height: 100vh;">
            <MudStack AlignItems="AlignItems.Center" Spacing="3">
                <MudProgressCircular Color="Color.Primary" Size="Size.Large" Indeterminate="true" />
                <MudText Typo="Typo.h5">Signing in with Microsoft...</MudText>
                <MudText Typo="Typo.body2" Class="mud-text-secondary">Please wait while we authenticate you.</MudText>
            </MudStack>
        </MudContainer>
    </LoggingIn>
    <CompletingLoggingIn>
        <MudContainer MaxWidth="MaxWidth.Small" Class="d-flex align-center justify-center" Style="height: 100vh;">
            <MudStack AlignItems="AlignItems.Center" Spacing="3">
                <MudProgressCircular Color="Color.Success" Size="Size.Large" Indeterminate="true" />
                <MudText Typo="Typo.h5">Completing sign in...</MudText>
                <MudText Typo="Typo.body2" Class="mud-text-secondary">Almost there!</MudText>
            </MudStack>
        </MudContainer>
    </CompletingLoggingIn>
    <LogOut>
        <MudContainer MaxWidth="MaxWidth.Small" Class="d-flex align-center justify-center" Style="height: 100vh;">
            <MudStack AlignItems="AlignItems.Center" Spacing="3">
                <MudProgressCircular Color="Color.Warning" Size="Size.Large" Indeterminate="true" />
                <MudText Typo="Typo.h5">Signing out...</MudText>
                <MudText Typo="Typo.body2" Class="mud-text-secondary">Please wait...</MudText>
            </MudStack>
        </MudContainer>
    </LogOut>
    <CompletingLogOut>
        <MudContainer MaxWidth="MaxWidth.Small" Class="d-flex align-center justify-center" Style="height: 100vh;">
            <MudStack AlignItems="AlignItems.Center" Spacing="3">
                <MudProgressCircular Color="Color.Info" Size="Size.Large" Indeterminate="true" />
                <MudText Typo="Typo.h5">Completing sign out...</MudText>
                <MudText Typo="Typo.body2" Class="mud-text-secondary">Almost there!</MudText>
            </MudStack>
        </MudContainer>
    </CompletingLogOut>
    <LogInFailed>
        <MudContainer MaxWidth="MaxWidth.Small" Class="mt-5">
            <MudAlert Severity="Severity.Error" Variant="Variant.Filled" Class="mb-4">
                <MudStack Spacing="2">
                    <MudText Typo="Typo.h6">
                        <MudIcon Icon="@Icons.Material.Filled.Warning" Class="mr-2" />
                        Authentication Failed
                    </MudText>
                    <MudText Typo="Typo.body2">We couldn't sign you in. This could be due to:</MudText>
                    <MudList T="string" Dense="true">
                        <MudListItem>Invalid or expired credentials</MudListItem>
                        <MudListItem>Missing required permissions (User.Read, Calendars.Read)</MudListItem>
                        <MudListItem>Azure AD app registration configuration issues</MudListItem>
                    </MudList>
                </MudStack>
            </MudAlert>
            <MudStack Row="true" Spacing="2">
                <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/"
                           StartIcon="@Icons.Material.Filled.Home">
                    Return to Home
                </MudButton>
                <MudButton Variant="Variant.Outlined" Color="Color.Primary" Href="authentication/login"
                           StartIcon="@Icons.Material.Filled.Refresh">
                    Try Again
                </MudButton>
            </MudStack>
        </MudContainer>
    </LogInFailed>
    <LogOutFailed>
        <MudContainer MaxWidth="MaxWidth.Small" Class="mt-5">
            <MudAlert Severity="Severity.Warning" Variant="Variant.Filled" Class="mb-4">
                <MudStack Spacing="2">
                    <MudText Typo="Typo.h6">
                        <MudIcon Icon="@Icons.Material.Filled.Warning" Class="mr-2" />
                        Sign Out Failed
                    </MudText>
                    <MudText Typo="Typo.body2">We couldn't complete the sign out process.</MudText>
                </MudStack>
            </MudAlert>
            <MudButton Variant="Variant.Filled" Color="Color.Primary" Href="/"
                       StartIcon="@Icons.Material.Filled.Home">
                Return to Home
            </MudButton>
        </MudContainer>
    </LogOutFailed>
</RemoteAuthenticatorView>

@code {
    [Parameter]
    public string? Action { get; set; }
}
